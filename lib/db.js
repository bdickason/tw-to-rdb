// Generated by CoffeeScript 1.4.0

/* Data models and interface with Redis
*/


(function() {
  var Db, Redis;

  Redis = require('redis');

  exports.Db = Db = (function() {

    function Db(cfg) {
      this.redis = Redis.createClient(cfg.REDIS_PORT, cfg.REDIS_HOSTNAME);
      this.redis.on('error', function(err) {
        return console.log('REDIS Error:' + err);
      });
    }

    Db.prototype.setAccessTokens = function(user_name, app_name, access_token, access_token_secret, callback) {
      if (user_name && app_name) {
        return this.redis.hmset("user:" + user_name + ":" + app_name, "access_token", access_token, "access_token_secret", access_token_secret, "active", 1, function(error, reply) {
          return callback(error, reply);
        });
      } else {
        if (!user_name) {
          return callback("Error: User Name not set");
        } else if (!app_name) {
          return callback("Error: App Name not set");
        }
      }
    };

    Db.prototype.getAccessTokens = function(user_name, app_name, callback) {
      var _this = this;
      if (user_name && app_name) {
        return this.redis.hgetall("user:" + user_name + ":" + app_name, function(error, reply) {
          return callback(error, reply);
        });
      } else {
        return callback("Error.");
      }
    };

    return Db;

  })();

}).call(this);
